/**
 * Short version for minified scripts:
 *
 * The MIT License (MIT)
 * Copyright (c) 2022 Espen Klem
 *
 * Full license text + Third party licenses found in ./LICENSES.txt
 */

"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t="0123456789bcdefghjkmnpqrstuvwxyz";class e{static encode(n,a,r){if(void 0===r){for(let t=1;t<=12;t++){const r=e.encode(n,a,t),s=e.decode(r);if(s.lat==n&&s.lon==a)return r}r=12}if(n=Number(n),a=Number(a),r=Number(r),isNaN(n)||isNaN(a)||isNaN(r))throw new Error("Invalid geohash");let s=0,o=0,c=!0,h="",d=-90,i=90,l=-180,w=180;for(;h.length<r;){if(c){const t=(l+w)/2;a>=t?(s=2*s+1,l=t):(s*=2,w=t)}else{const t=(d+i)/2;n>=t?(s=2*s+1,d=t):(s*=2,i=t)}c=!c,5==++o&&(h+=t.charAt(s),o=0,s=0)}return h}static decode(t){const n=e.bounds(t),a=n.sw.lat,r=n.sw.lon,s=n.ne.lat,o=n.ne.lon;let c=(a+s)/2,h=(r+o)/2;return c=c.toFixed(Math.floor(2-Math.log(s-a)/Math.LN10)),h=h.toFixed(Math.floor(2-Math.log(o-r)/Math.LN10)),{lat:Number(c),lon:Number(h)}}static bounds(e){if(0==e.length)throw new Error("Invalid geohash");e=e.toLowerCase();let n=!0,a=-90,r=90,s=-180,o=180;for(let c=0;c<e.length;c++){const h=e.charAt(c),d=t.indexOf(h);if(-1==d)throw new Error("Invalid geohash");for(let t=4;t>=0;t--){const e=d>>t&1;if(n){const t=(s+o)/2;1==e?s=t:o=t}else{const t=(a+r)/2;1==e?a=t:r=t}n=!n}}return{sw:{lat:a,lon:s},ne:{lat:r,lon:o}}}static adjacent(n,a){if(n=n.toLowerCase(),a=a.toLowerCase(),0==n.length)throw new Error("Invalid geohash");if(-1=="nsew".indexOf(a))throw new Error("Invalid direction");const r=n.slice(-1);let s=n.slice(0,-1);const o=n.length%2;return-1!={n:["prxz","bcfguvyz"],s:["028b","0145hjnp"],e:["bcfguvyz","prxz"],w:["0145hjnp","028b"]}[a][o].indexOf(r)&&""!=s&&(s=e.adjacent(s,a)),s+t.charAt({n:["p0r21436x8zb9dcf5h7kjnmqesgutwvy","bc01fg45238967deuvhjyznpkmstqrwx"],s:["14365h7k9dcfesgujnmqp0r2twvyx8zb","238967debc01fg45kmstqrwxuvhjyznp"],e:["bc01fg45238967deuvhjyznpkmstqrwx","p0r21436x8zb9dcf5h7kjnmqesgutwvy"],w:["238967debc01fg45kmstqrwxuvhjyznp","14365h7k9dcfesgujnmqp0r2twvyx8zb"]}[a][o].indexOf(r))}static neighbours(t){return{n:e.adjacent(t,"n"),ne:e.adjacent(e.adjacent(t,"n"),"e"),e:e.adjacent(t,"e"),se:e.adjacent(e.adjacent(t,"s"),"e"),s:e.adjacent(t,"s"),sw:e.adjacent(e.adjacent(t,"s"),"w"),w:e.adjacent(t,"w"),nw:e.adjacent(e.adjacent(t,"n"),"w")}}}function n(t){return t*(Math.PI/180)}exports.Geohash=e,exports.getDistanceFromLatLonInKm=function(t,e,a,r){const s=n(a-t),o=n(r-e),c=Math.sin(s/2)*Math.sin(s/2)+Math.cos(n(t))*Math.cos(n(a))*Math.sin(o/2)*Math.sin(o/2);return 6371*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))};
